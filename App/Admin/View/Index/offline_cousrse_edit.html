<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>offline</title>
    <link rel="stylesheet" href="__ACSS__/main.css">
    <link rel="stylesheet" href="__ACSS__/index.css" />
    <link rel="stylesheet" href="__ACSS__/upload.css" />
    <link href="__ADATEPICK__/js/datetimepicker/datepicker.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="__ACSS__/font-awesome.min.css">
    <script type="text/javascript" charset="utf-8" src="__AEDITOR__/ueditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="__AEDITOR__/ueditor.all.min.js">
    </script>
    <script type="text/javascript" charset="utf-8" src="__AEDITOR__/lang/zh-cn/zh-cn.js"></script>

</head>

<body class="bf2">

    <!-- sub nav -->
    <div class="sub_nav pl20 pt10">
        <span class="route">
        <span class="router router1">业务管理/课程管理</span>
        </span>
    </div>

    <div class="sub_nav pl20 pt10 mt20">
        <span class="route">
        <span class="router router1">课程信息</span>
        </span>
    </div>


    <form action="{:U('Admin/OffLine/index')}" class="editor" name="frm2">


        <section class="widget_wrp h170">
            <div class="f_l w500">
                <div class="mb15">
                    <span class="i_block w100 texy_a_r ">课程名称:</span>
                    <input type="text" class="w250 courses_name" name='course_name'>
                </div>
                <div class="mb15">
                    <span class="i_block w100 texy_a_r ">讲师姓名:</span>
                    <input type="text" class="w250 teacher_name" name="teach_name">
                </div>
                <div>
                    <span class="i_block w100 texy_a_r">现价:</span>
                    <input type="text" class="w80 current_price" name="current_price">
                    <span class="ml50">原价:</span>
                    <input type="text" class="w80 course_price" name="course_price">
                </div>
            </div>

            <div class="mb15">
                <span class="i_block w100 texy_a_r">开始上课时间:</span>
                <input type="text" id="startTime" class="am-form-field w250" data-am-datepicker name="startTime" />
            </div>
            
            <div class="f_l w500">
                <div class="mb15">
                    <span class="i_block w100 texy_a_r ">课节数量:</span>
                    <input type="text" class="w250 courses_num" maxlength="5" name="class_num">
                </div>
                <div class="mb15">
                    <span class="i_block w100 texy_a_r">开始上课时间:</span>
                    <input type="text" id="startTime" class="am-form-field w250" data-am-datepicker name="startTime" />
                </div>
            </div>
            <div class="mb15 relative ">
                <span class="i_block w100 texy_a_r absolute">上传封面:</span>
                <div class="upload-img">
                     <span class="upload-btn" data-w="735" data-h="460" onclick="uploadStart(this)"><!-- btn --></span>
                     <input type="hidden" name="bigimg[]" value="{$sp.bigimg.0.big_pho}">
                </div>
            </div>
        </section>
    </form>

    <div class="sub_nav pl20 pt10">
        <span class="route">
        <span class="router router1">课程简介</span>

        </span>
    </div>
    <section class="widget_wrp h460">
        <textarea id="editor" type="text/plain" style="width:800px;height:300px;"></textarea>
        <script type="text/javascript">
            var ue = UE.getEditor('editor');
        </script>
    </section>




    <div class="sub_nav pl20 pt10">
        <span class="route">
        <span class="router router1">课程表</span>
        <span class="router router1 float_r mr20 red addvideo pointer">添加课节</span>
        </span>
    </div>

    <section class="widget_wrp">
        <!-- 表格主体 -->
        <table class="table_default">
            <tr>
                <th width="12%">课程名称</th>
                <th width="10%">上课时间</th>
                <th width="11%">操作</th>
            </tr>
            <foreach name='classa' item='v'>
                <tr class="h50 clone">
                    <td>
                        {$v.class_name}
                    </td>
                    <td>{$v.class_time}</td>
                    <td class="operation">
                        <a href="" class="mr2 edit">
                            <i class="fa fa-edit vm"></i> 编辑
                        </a>
                        <span class="ccc">|</span>
                        <span class="pointer ml2 remove">
    					<i class="fa fa-trash vm"></i>
    					删除
    				</span>
                        <!-- 删除提示 -->
                        <div class="deleConfirm">
                            <span class="mbutton trans confirm mt10">
                            <input name="" class="zxc" type="hidden" value="{$v.id}"><i class="fa fa-check mr4"></i>确认
                            </span>
                            <span class="mbutton trans cancel"><i class="fa fa-times mr4"></i>取消</span>
                        </div>
                    </td>
                </tr>
            </foreach>

        </table>

        <!-- 尾部 -->
        <div class="table_footer mb30">
            <div class="operate_btn_box f_r mr30">
                <input type="button" class="button btn_middle btn_primary trans pointer saveall" value="保存">
            </div>
        </div>
    </section>

    <div class="modal">
        <div class="back"></div>
        <div class="video_modal_main_edit">
            <h2>编辑课节</h2>

            <div class="m_m_video">
                <p><span>课节名称：</span>
                    <input type="text" class="w200 coursename" name="coursename">
                </p>

                <p>
                    <span>上课时间：</span>
                    <input type="text" id="startTime1" class="am-form-field w200 class_time" data-am-datepicker name="class_time" />
                </p>
                <p>
                    <span class="inline-block w70"></span>
                    <input type="text" class="w50 hour">
                    <span class="">小时</span>
                    <input type="text" class="w50 minute">
                    <span class="">分</span>
                </p>
            </div>

            <span class="videosave pointer">保存</span><span class="videocancel pointer">取消</span>
        </div>
    </div>

    <script src="__AJS__/jquery.js"></script>
    <script src="__AJS__/jquery.easing.js"></script>
    <script src="__AJS__/deleconfirm.js"></script>
    <script type="text/javascript" src="__AJS__/jquery.upload.js"></script>
    <script type="text/javascript" src="__ADATEPICK__/js/datetimepicker/datepicker.min.js"></script>
    <script type="text/javascript" src="__ADATEPICK__/js/datetimepicker/datepicker.zh-CN.js"></script>
    <script type="text/javascript">
        var uploadActionUrl = "{:U('Audio/uploadimg')}";
    </script>
    <script type="text/javascript">
        'use strict';
        var option = {
            dateFormat: "yyyy-m-d",
            autoClose: true,
            weekStart: 7
        };
        $("#startTime").datepicker(option);
        $("#startTime1").datepicker(option);
        $("#endTime").datepicker(option);

        let courses_name = document.querySelector('.courses_name'),
            teacher_name = document.querySelector('.teacher_name'),
            courses_num = document.querySelector('.courses_num');
        $(function() {
            $('.courses_num').keyup(function() {
                'use strict';
                let num = $('.courses_num').val(),
                    strnum = num.split('');
                if (strnum.length >= 3) {
                    let newstr = num.split('', 3).join('');
                    console.log(newstr)
                    $('.courses_num').val(newstr)
                }
            });

            $('.addvideo').click(function() {
                'use strict';
                $('.modal').show();
                $('.video_modal_main_edit').show();
                $('.m_m_offline').hide()
                $('.m_m_audio').hide()
                $('.videocancel').click(function() {
                    $('.modal').hide()
                })
            });

            $('.videosave').click(function() {
                'use strict';
                $('.modal').hide();
                var app = $('.table_default tr.clone').eq(0).clone(true);
                var data = $('#startTime1').val();
                app.find('td').eq(0).text($('.coursename').val());
                app.find('td').eq(1).text(data + " " + $('.hour').val() + ':' + $('.minute').val());
                app.appendTo('.table_default');
                $.post("{:U('Admin/Class/addOffLine')}", {
                    'class_name': $('.coursename').val(),
                    'class_time': $('.class_time').val()
                }, function(data) {
                    if (data.status) {

                    }
                });
            });

            $('.saveall').click(function(e) {
                e.preventDefault();
                let editor = $('.view').html();
                console.log(editor);
                $('form.editor').submit();

//                $.post("{:U('Admin/OffLine/index')}", {
//                    'course_name': $('.courses_name').val(),
//                    'course_price': $('.course_price').val(),
//                    'current_price': $('.current_price').val(),
//                    'teach_name': $('.teacher_name').val(),
//                    'class_num': $('.courses_num').val(),
//                    'addtime': $('#startTime').val()
//                }, function(data) {
//                    if (data.status) {
//
//                    }
//                });
            })
            $("span.confirm").click(function() {

                let id = $(this).find('.zxc').attr('value')
                console.log(id);
                $.post('{:U("Admin/Class/delClass")}', {
                    id: id
                }, function() {

                })
            })


            $('.back').click(function() {
                $('.modal').hide()
            });

            $('.operation .edit').click(function(e) {
                'use strict';
                e.preventDefault();
                $('.modal').show();
                $('.video_modal_main_edit').show();
                $('.m_m_offline').hide()
                $('.m_m_audio').hide()
                $('.videocancel').click(function() {
                    $('.modal').hide()
                })
                $('.videosave').click(function() {
                    $('.modal').hide()
                })
            });
        })
    </script>
</body>

</html>