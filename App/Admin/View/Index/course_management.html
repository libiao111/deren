<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>组件</title>
    <link rel="stylesheet" href="__ACSS__/main.css">
    <link rel="stylesheet" href="__ACSS__/index.css" />
    <link rel="stylesheet" type="text/css" href="__ACSS__/font-awesome.min.css">
    <style>
        
        .current{
            display:inline-block;
            width:10px;
            height:15px;
            
        }
    </style>
</head>

<body class="bf2">

    <!-- sub nav -->
    <div class="sub_nav pl20 pt10">
        <span class="route">
            <a href="dash.html" target="frame"><i class="fa fa-home fa-lg"></i></a>
            <span class="slashes slashes1 ml8 mr8 rel"></span>
        <span class="router router1">内容管理/课程管理</span>
        </span>
    </div>
    <section class="widget_wrp">
        <!--        <h2>表格</h2>-->
        <!-- 头部 -->
        <div class="table_header mt30">
            <!-- 下拉列表组件 -->
            <form action="{:U('Course/course')}" method="get" name="frm" class="frm" enctype="multipart/form-data">
                <span class="select_wrap ml30 mt15 dib">

                <span>课程分类：</span>

                <select class="ipt_default btn_large type" name="type">
                    <option value="0" <if condition="$type eq 0">selected</if>>全部</option>
                    <option value="1" <if condition="$type eq 1">selected</if>>线下课</option>
                    <option value="2" <if condition="$type eq 2">selected</if>>音频课</option>
                    <option value="3" <if condition="$type eq 3">selected</if>>视频课</option>
                </select>
                <i class="fa fa-caret-down"></i>
                </span>
                <span class="select_wrap ml10 mt15 dib">
                <span>课程状态：</span>
                <select class="ipt_default btn_middle aa" name="status">
                    <option value="0" <if condition="$status eq 0">selected</if>>全部</option>
                    <option value="1" <if condition="$status eq 1">selected</if>>停用</option>
                    <option value="2" <if condition="$status eq 2">selected</if>>启用</option>
                </select>
                <i class="fa fa-caret-down"></i>
                </span>
                <!-- 按钮 -->
                <a href="">
                    <input type="button" class="add_course button btn_middle btn_primary r mr30 mt15 pointer" value="添加课程">
                </a>
            </form>
        </div>

        <!-- 表格主体 -->
        <table class="table_default">
            <tr>
                <th width="6%">
                    <input type="checkbox" class="checkall">
                </th>
                <th width="12%">课程封面</th>
                <th width="15%">课程名称</th>
                <th width="10%">课程分类</th>
                <th width="10%">课程数量</th>
                <th width="8%">讲师姓名</th>
                <th width="10%">开始上课时间</th>
                <th width="10%">课程总时长</th>
                <th width="8%">状态</th>
                <th width="11%">操作</th>
            </tr>
            <foreach name="course" item="v">
                <tr>
                    <td width="6%">
                        <input class="check" type="checkbox" id="{$v.id}" value="{$v.id}">
                    </td>
                    <td><img src="__UPFILE__/{$v.course_photo}" height="60px" class="mt8 mb8"></td>
                    <td>{$v.course_name}</td>
                    <td class="kc_type">
                        <if condition="$v.type eq 1">线下课
                            <elseif condition="$v.type eq 2" />音频课
                            <elseif condition="$v.type eq 3" /> 视频课
                            <else />
                        </if>
                    </td>
                    <td>{$v.class_num}</td>
                    <td>{$v.teach_name}</td>
                    <td>{$v.addtime}</td>
                    <td>{$v.classtime}</td>
                    <td>
                        <if condition="$v.status eq 2">启用
                            <elseif condition="$v.status eq 1" />停用
                            <else/>
                        </if>
                    </td>
                    <td class="operation">
                        <a href="" class="mr2 edit">
                            <i class="fa fa-edit vm"></i> 编辑
                        </a>
                    </td>
                </tr>
            </foreach>
        </table>

        <!-- 尾部 -->
        <div class="table_footer mb30">
            <div class="operate_btn_box">
                <input type="button" class="button btn_middle btn_primary trans pointer enable" value="启用">
                <input type="button" class="button btn_middle btn_primary trans pointer disable" value="停用">
                <input type="button" class="button btn_middle btn_primary trans pointer delete" value="删除">
            </div>
            <!-- 分页 -->
            <div class="pagination mr30" name="page">
                {$page}
                <!-- <span class="pagination_item pagination_item_on" name="page">{$pages}</span>
                <span class="pagination_item"></span>
                <span class="pagination_item">3</span>
                <span class="pagination_item">4</span>
                <span class="pagination_item">5</span>
                <span class="pagination_item">6</span>
                <span class="pagination_item">7</span>  -->
            </div>
        </div>
    </section>
    <div class="hint">
        <!--        <div class="hintback"></div>-->
        <div class="hintmain">
            <p></p>
        </div>
    </div>

    <div class="modal">
        <div class="back"></div>
        <div class="modal_main_edit">
            <h2>编辑课节</h2>

            <div class="m_m_video">
                <p><span></span>
                    <input type="text">
                </p>
                <p>
                    <span></span>
                    <input type="text" class="w80">
                    <span class=""></span>
                    <input type="text" class="w80">
                </p>
                <p><span></span><span></span><span class=""></span></p>
            </div>

            <div class="m_m_offline">
                <p><span></span>
                    <input type="text">
                </p>
                <p><span></span>
                    <input type="text" id="startTime" class="am-form-field w250" data-am-datepicker>
                </p>
            </div>

            <div class="m_m_audio">
                <p><span></span>
                    <input type="text">
                </p>
                <p>
                    <span></span>
                    <input type="text" class="w80">
                    <span class=""></span>
                    <input type="text" class="w80">
                </p>
                <p><span></span><span></span><span class=""></span></p>
                <p><span></span></p>
            </div>

            <span>保存</span><span>取消</span>
        </div>


        <!--        table底部三个按钮-->
        <div class="modal_main_three">
            <p></p>
            <div>
                <span class="cancel pointer">取消</span>
                <span class="confirm pointer">确认</span>
            </div>
        </div>

        <div class="modal_add_course">
            <div class="top">
                <span class="f_s20">选择课程分类：</span>
                <select name="" id="select_course" class="f_s20">
                    <option value="1">线下课</option>
                    <option value="2">音频课</option>
                    <option value="3">视频课</option>
                </select>
            </div>
            <div class="bottom">
                <span class="cancel pointer">取消</span>
                <span class="confirm pointer"><a href="{:U('index',array('id'=>1))}">确认</a></span>
            </div>
        </div>
        <div class="modal_mian_add">
            <h2></h2>

            <div class="add_audio">
                <p><span></span>
                    <input type="text">
                </p>
                <p>
                    <span></span>
                    <input type="text" class="w80">
                    <span class=""></span>
                    <input type="text" class="w80">
                </p>
                <p>
                    <span></span>
                    <input type="file" class="w80">
                </p>
                <p>
                    <span></span>
                    <input type="file" class="w80">
                </p>
            </div>

            <div class="add_video">
                <p><span></span>
                    <input type="text">
                </p>
                <p>
                    <span></span>
                    <input type="text" class="w80">
                    <span class=""></span>
                    <input type="text" class="w80">
                </p>
                <p>
                    <span></span>
                    <input type="file" class="w80">
                </p>
            </div>

            <div class="add_offline">
                <p><span></span>
                    <input type="text">
                </p>
                <p><span></span>
                    <input type="text" id="startTime" class="am-form-field w250" data-am-datepicker>
                </p>
            </div>

            <div><span></span><span></span></div>
        </div>
    </div>
    <script src="__AJS__/jquery.upload.js"></script>
    <script src="__AJS__/jquery.js"></script>
    <script src="__AJS__/jquery.easing.js"></script>
    <script src="__AJS__/deleconfirm.js"></script>
    <script>
        $(function () {
            $('.checkall').click(function () {
                'use strict';
                var this_ = $(this);
                if (this_.prop('checked')) {
                    this_.parents('tr').siblings('tr').find('td:eq(0)>input[type="checkbox"]').prop("checked", true);
                }
                else{
                    this_.parents('tr').siblings('tr').find('td:eq(0)>input[type="checkbox"]').prop("checked", false);
                }
            })

            $('.type').change(function () {
                $('.frm').submit();
            });
            $('.aa').change(function () {
                $('.frm').submit();
            });

            $('.enable').click(function () {
                    'use strict';
                    $('.hint').show();
                    $('.hintmain').show();
                    $('.hintmain>p').text('操作成功!');
                    setTimeout(function () {
                        $('.hint').hide();
                    }, 1000);

                    let id = [],
                        tid = $('td>input[type="checkbox"]:checked');
                    tid.each(function () {
                        id.push(parseInt($(this).attr('id')));
                    });

                    $.post('{:U("Admin/Course/enablestatus")}', {
                        id: id
                    }, function (data) {
                        if (data.status) {
                            setTimeout(function () {
                                $('.hint').hide();
                                window.location.reload();
                            }, 1000)
                        }
                    });
                })
                //disable operation
            $('.disable').click(function () {
                'use strict';
                $('.hint').show();
                $('.hintmain').show();
                $('.hintmain>p').text('操作成功!');
                setTimeout(function () {
                    $('.hint').hide();
                }, 1000);
                let id = [],
                    tid = $('td>input[type="checkbox"]:checked');
                tid.each(function () {
                    id.push(parseInt($(this).attr('id')));
                });

                $.post('{:U("Admin/Course/disablestatus")}', {
                    id: id
                }, function (data) {
                    if (data.status) {

                        setTimeout(function () {
                            $('.hint').hide();
                            window.location.reload();
                        }, 1000)
                    }
                });
            })
            $('.delete').click(function () {
                'use strict';
                let id = [],
                    tid = $('td>input[type="checkbox"]:checked');
                tid.each(function () {
                    id.push(parseInt($(this).attr('id')));
                });
                
                $.post("{:U('Admin/Course/delCourse')}", {
                    id:id
                }, function (data) {
                    if (data.status) {
                        $('.hint').show();
                        $('.hintmain').show();
                        $('.hintmain>p').text('操作成功!');
                        setTimeout(function () {
                            setTimeout(function () {
                                $('.hint').hide();
                            }, 1000);
                            window.location.reload();
                        }, 1000)
                    }
                });
            })


            var add_cour_btn = document.querySelector('.add_course');
            var modal_add_course = document.querySelector('.modal_add_course'),
                modal_add_course_cancel = document.querySelector('.modal_add_course').querySelector('.bottom').querySelector('.cancel'),
                modal_add_course_confirm = document.querySelector('.modal_add_course').querySelector('.bottom').querySelector('.confirm'),
                modal = document.querySelector('.modal'),
                modal_back = document.querySelector('.back'),
                modal_main_three = document.querySelector('.modal_main_three'),
                iframe = document.querySelector('iframe');


            add_cour_btn.onclick = function (event) {
                'use strict';
                event.preventDefault();
                modal.style.display = 'block';
                modal_add_course.style.display = 'block'
            }
            modal_add_course_cancel.onclick = function () {
                'use strict';
                modal.style.display = 'none';
                modal_add_course.style.display = 'none'
            }

            //modal back operation
            modal_back.onclick = function () {
                'use strict';
                modal.style.display = 'none';
                modal_add_course.style.display = 'none'
            }


            modal_add_course_confirm.onclick = function () {
                'use strict';
                let select = document.querySelector('#select_course').value;

                if (select == "1") {
                    location.href = "{:U('index/offline_cousrse_edit')}"
                } else if (select == "2") {
                    location.href = "{:U('index/audio_cousrse_edit')}"
                } else if (select == '3') {
                    location.href = "{:U('index/video_cousrse_edit')}"
                }
            }


            //table中编辑按钮操作
            $('.edit').click(function (e) {
                'use strict';
                e.preventDefault();
                var this_ = $(this);
                
                let kc = this_.parent().siblings('td.kc_type').text().trim();
                let lu  = "";
                if (kc == "线下课") {
                   lu = "{:U('OffLine/index')}";
                } else if (kc == "视频课") {
                    lu = "{:U('Video/index')}";
                } else if (kc == "音频课") {
                    lu = "{:U('Audio/index')}";
                }
                $.post(lu,{},function(){
                    
                })
            })

            //table底部三个按钮操作
            "use strict"
            var enable_btn = document.querySelector('.operate_btn_box').querySelector('.enable'),
                disable_btn = document.querySelector('.operate_btn_box').querySelector('.disable'),
                delete_btn = document.querySelector('.operate_btn_box').querySelector('.delete'),
                three_box = document.querySelector('.modal_main_three');

            var modal_main_three_cancel = document.querySelector('.modal_main_three').querySelector('div').querySelector('.cancel'),
                modal_main_three_confirm = document.querySelector('.modal_main_three').querySelector('div').querySelector('.confirm');

            modal_main_three_cancel.onclick = function () {
                'use strict';
                modal.style.display = 'none';
                modal_add_course.style.display = 'none'
            }
            modal_main_three_confirm.onclick = function () {
                'use strict';
                //to do
            }
        });
    </script>
</body>

</html>